{
  "runbook_name": "Overview Example",
  "package_name": "example_overview",
  "description": "Demonstrates feature graph versioning and change tracking",
  "execution_state": {
    "events": [
      {
        "type": "graph_pushed",
        "snapshot_version": "4b946d29",
        "graph": {
          "example/video": {
            "metaxy_feature_version": "c2ac395f",
            "fields": {
              "audio": "22742381",
              "frames": "794116a9"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {},
              "description": "Video metadata feature (root)."
            }
          },
          "example/crop": {
            "metaxy_feature_version": "34d75856",
            "fields": {
              "audio": "4c726c4b",
              "frames": "2419e09d"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "f1526ee0",
            "fields": {
              "faces": "006efeef"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/stt": {
            "metaxy_feature_version": "d953dea4",
            "fields": {
              "transcription": "3ec3826d"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          }
        },
        "timestamp": "2026-02-04T09:35:36.755757",
        "scenario_name": "Initial feature graph",
        "step_name": null
      },
      {
        "type": "command_executed",
        "command": "metaxy push",
        "returncode": 0,
        "stdout": "4b946d29\n",
        "stderr": "Recorded at: {'name': 'dev', 'display': \n'DeltaMetadataStore(path=/tmp/pytest-of-dan/pytest-1117/test_example_snapshot_ex\nample_3/example-overview)', 'resolved_from': {'name': 'dev', 'type': \n'metaxy.metadata_store.delta.DeltaMetadataStore', 'display': \n'DeltaMetadataStore(path=/tmp/pytest-of-dan/pytest-1117/test_example_snapshot_ex\nample_3/example-overview)', 'uri': \n'/tmp/pytest-of-dan/pytest-1117/test_example_snapshot_example_3/example-overview\n/metaxy-system/feature_versions.delta'}}\nâœ“ Snapshot already recorded (no changes)\n",
        "timestamp": "2026-02-04T09:35:37.372608",
        "scenario_name": "Initial feature graph",
        "step_name": "push_graph"
      },
      {
        "type": "command_executed",
        "command": "metaxy graph render --format mermaid",
        "returncode": 0,
        "stdout": "---\ntitle: Feature Graph\n---\nflowchart TB\n    %% Snapshot version: 4b946d29\n    %%{init: {'flowchart': {'htmlLabels': true, 'curve': 'basis'}, 'themeVariables': {'fontSize': '14px'}}}%%\n        example_video[\"<div style=\"text-align:left\"><b>example/video</b><br/><small><font color=\"#666\">Project: example_overview</font></small><br/>c2ac395f<br/><font color=\"#999\">---</font><br/>- \naudio (22742381)<br/>- frames (794116a9)</div>\"]\n        example_crop[\"<div style=\"text-align:left\"><b>example/crop</b><br/><small><font color=\"#666\">Project: example_overview</font></small><br/>34d75856<br/><font color=\"#999\">---</font><br/>- audio\n(4c726c4b)<br/>- frames (2419e09d)</div>\"]\n        example_face_detection[\"<div style=\"text-align:left\"><b>example/face_detection</b><br/><small><font color=\"#666\">Project: example_overview</font></small><br/>f1526ee0<br/><font \ncolor=\"#999\">---</font><br/>- faces (006efeef)</div>\"]\n        example_stt[\"<div style=\"text-align:left\"><b>example/stt</b><br/><small><font color=\"#666\">Project: example_overview</font></small><br/>d953dea4<br/><font color=\"#999\">---</font><br/>- \ntranscription (3ec3826d)</div>\"]\n        example_video --> example_crop\n        example_crop --> example_face_detection\n        example_video --> example_stt\n\n",
        "stderr": "",
        "timestamp": "2026-02-04T09:35:38.193079",
        "scenario_name": "Initial feature graph",
        "step_name": "render_graph"
      },
      {
        "type": "graph_pushed",
        "snapshot_version": "c6f1cd92",
        "graph": {
          "example/video": {
            "metaxy_feature_version": "2faffb98",
            "fields": {
              "audio": "09c8398b",
              "frames": "794116a9"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "2",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {},
              "description": "Video metadata feature (root)."
            }
          },
          "example/crop": {
            "metaxy_feature_version": "fe237dc9",
            "fields": {
              "audio": "e2b6ce39",
              "frames": "2419e09d"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "f1526ee0",
            "fields": {
              "faces": "006efeef"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/stt": {
            "metaxy_feature_version": "e57e7555",
            "fields": {
              "transcription": "9f7ea40c"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          }
        },
        "timestamp": "2026-02-04T09:35:38.830249",
        "scenario_name": "Code change - audio field",
        "step_name": "update_audio_version"
      },
      {
        "type": "patch_applied",
        "patch_path": "patches/01_update_audio_version.patch",
        "before_snapshot": "4b946d29",
        "after_snapshot": "c6f1cd92",
        "before_graph": {
          "example/video": {
            "metaxy_feature_version": "c2ac395f",
            "fields": {
              "audio": "22742381",
              "frames": "794116a9"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {},
              "description": "Video metadata feature (root)."
            }
          },
          "example/crop": {
            "metaxy_feature_version": "34d75856",
            "fields": {
              "audio": "4c726c4b",
              "frames": "2419e09d"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "f1526ee0",
            "fields": {
              "faces": "006efeef"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/stt": {
            "metaxy_feature_version": "d953dea4",
            "fields": {
              "transcription": "3ec3826d"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          }
        },
        "after_graph": {
          "example/video": {
            "metaxy_feature_version": "2faffb98",
            "fields": {
              "audio": "09c8398b",
              "frames": "794116a9"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "2",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {},
              "description": "Video metadata feature (root)."
            }
          },
          "example/crop": {
            "metaxy_feature_version": "fe237dc9",
            "fields": {
              "audio": "e2b6ce39",
              "frames": "2419e09d"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "f1526ee0",
            "fields": {
              "faces": "006efeef"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          },
          "example/stt": {
            "metaxy_feature_version": "e57e7555",
            "fields": {
              "transcription": "9f7ea40c"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {},
              "description": null
            }
          }
        },
        "timestamp": "2026-02-04T09:35:38.842673",
        "scenario_name": "Code change - audio field",
        "step_name": "update_audio_version"
      },
      {
        "type": "command_executed",
        "command": "metaxy graph-diff render latest current --format mermaid",
        "returncode": 0,
        "stdout": "---\ntitle: Feature Graph Changes\n---\nflowchart TB\n    %%{init: {'flowchart': {'htmlLabels': true, 'curve': 'basis'}, 'themeVariables': {'fontSize': '14px'}}}%%\n\n    example_face_detection[\"<div style=\"text-align:left\"><b>example/face_detection</b><br/>f1526e<br/><font color=\"#999\">---</font><br/>- faces (006efe)</div>\"]\n    example_stt[\"<div style=\"text-align:left\"><b>example/stt</b><br/>e57e75<br/><font color=\"#999\">---</font><br/>- transcription (9f7ea4)</div>\"]\n    example_video[\"<div style=\"text-align:left\"><b>example/video</b><br/>2faffb<br/><font color=\"#999\">---</font><br/>- audio (09c839)<br/>- frames (794116)</div>\"]\n    example_crop[\"<div style=\"text-align:left\"><b>example/crop</b><br/>fe237d<br/><font color=\"#999\">---</font><br/>- audio (e2b6ce)<br/>- frames (2419e0)</div>\"]\n\n    example_crop --> example_face_detection\n    example_video --> example_stt\n    example_video --> example_crop\n\n",
        "stderr": "",
        "timestamp": "2026-02-04T09:35:39.486319",
        "scenario_name": "Code change - audio field",
        "step_name": "render_diff"
      }
    ]
  }
}
