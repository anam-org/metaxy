{
  "runbook_name": "Overview Example",
  "package_name": "example_overview",
  "description": "Demonstrates feature graph versioning and change tracking",
  "execution_state": {
    "events": [
      {
        "type": "graph_pushed",
        "snapshot_version": "8468950dcc9f75e4089529577e7b8ba044205e16a7c32b54910e7c73b9f7303d",
        "graph": {
          "example/video": {
            "metaxy_feature_version": "bc9ca8356b1b8d2e2e25455bc8d0d4c51d00dfe826f08df38bbf8df0042fc890",
            "fields": {
              "audio": "2274238132e8ddf5b2f64bd926e35f3dbcf910e45f49a0d1f3383b1a28421b49",
              "frames": "794116a95021306600942624e8f40f8166c9ff87bb155835685c26a72a32fd85"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {}
            }
          },
          "example/crop": {
            "metaxy_feature_version": "3ac04df8f6503f82cbcd06f0e1cc5f4589c9bacb065b7edf22cd9567ad302c63",
            "fields": {
              "audio": "76c8bdc9545524e878ed4d9890587551b6c3154251cdfcca9049cbacf112cc39",
              "frames": "abc79017997391ffa25bdf04cbab84d77fdd22f4d2d78b914acad0662915e086"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "1ac83b074c018d1524eb51cf7f19734175b34c72f8289b6b90015f4a0ab9e2ce",
            "fields": {
              "faces": "2d75f0bd5be71867c23389d26bbd00eba2f3498dfff334dc0bbcaa9ec3893b07"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/stt": {
            "metaxy_feature_version": "c83a754a1749050d358b0e2572a7f3538ab5e76e18222f4c23dd7ef96e50b162",
            "fields": {
              "transcription": "ac412b3c78c2f910127bdd1511cf08ff0fe9324a80c0fe0503f2edabb22960d2"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          }
        },
        "timestamp": "2026-01-08T13:31:06.823400",
        "scenario_name": "Initial feature graph",
        "step_name": null
      },
      {
        "type": "command_executed",
        "command": "metaxy graph push",
        "returncode": 0,
        "stdout": "8468950dcc9f75e4089529577e7b8ba044205e16a7c32b54910e7c73b9f7303d\n",
        "stderr": "Recorded at: {'display': 'DuckDBMetadataStore(backend=duckdb)', 'table_name': \n'metaxy_system__feature_versions'}\nâœ“ Snapshot already recorded (no changes)\n",
        "timestamp": "2026-01-08T13:31:08.114861",
        "scenario_name": "Initial feature graph",
        "step_name": "push_graph"
      },
      {
        "type": "command_executed",
        "command": "metaxy graph render --format mermaid",
        "returncode": 0,
        "stdout": "---\ntitle: Feature Graph\n---\nflowchart TB\n    %% Snapshot version: 8468950d\n    %%{init: {'flowchart': {'htmlLabels': true, 'curve': 'basis'}, 'themeVariables': {'fontSize': '14px'}}}%%\n        example_video[\"<div style=\"text-align:left\"><b>example/video</b><br/><small><font color=\"#666\">Project: example-overview</font></small><br/>bc9ca835<br/><font color=\"#999\">---</font><br/>- \naudio (22742381)<br/>- frames (794116a9)</div>\"]\n        example_crop[\"<div style=\"text-align:left\"><b>example/crop</b><br/><small><font color=\"#666\">Project: example-overview</font></small><br/>3ac04df8<br/><font color=\"#999\">---</font><br/>- audio\n(76c8bdc9)<br/>- frames (abc79017)</div>\"]\n        example_face_detection[\"<div style=\"text-align:left\"><b>example/face_detection</b><br/><small><font color=\"#666\">Project: example-overview</font></small><br/>1ac83b07<br/><font \ncolor=\"#999\">---</font><br/>- faces (2d75f0bd)</div>\"]\n        example_stt[\"<div style=\"text-align:left\"><b>example/stt</b><br/><small><font color=\"#666\">Project: example-overview</font></small><br/>c83a754a<br/><font color=\"#999\">---</font><br/>- \ntranscription (ac412b3c)</div>\"]\n        example_video --> example_crop\n        example_crop --> example_face_detection\n        example_video --> example_stt\n\n",
        "stderr": "",
        "timestamp": "2026-01-08T13:31:09.087536",
        "scenario_name": "Initial feature graph",
        "step_name": "render_graph"
      },
      {
        "type": "graph_pushed",
        "snapshot_version": "980943fbb9465022ca100716e64670fbbd80ef63636d4c23f18318454a77db4c",
        "graph": {
          "example/video": {
            "metaxy_feature_version": "6db302e5be0167551ad6a00df92e10a54ea63d7a6f393d420eeb23f24b540b10",
            "fields": {
              "audio": "09c8398bb8d6ef79c622cec3f7ee402cd55ad577a6002ddb7cd377b1a4af4377",
              "frames": "794116a95021306600942624e8f40f8166c9ff87bb155835685c26a72a32fd85"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "2",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {}
            }
          },
          "example/crop": {
            "metaxy_feature_version": "54dc7f8a47f2e4430707310fecc57101785040403680402b0013f5160024ee42",
            "fields": {
              "audio": "f3130c0fc1eb3967dbe4ed248be5b935334260f7afc5e0d878a5022c77b3475a",
              "frames": "abc79017997391ffa25bdf04cbab84d77fdd22f4d2d78b914acad0662915e086"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "1ac83b074c018d1524eb51cf7f19734175b34c72f8289b6b90015f4a0ab9e2ce",
            "fields": {
              "faces": "2d75f0bd5be71867c23389d26bbd00eba2f3498dfff334dc0bbcaa9ec3893b07"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/stt": {
            "metaxy_feature_version": "066d34fcb84150b926500d1ba1172f53e3506643c743d4403a19128a6ae17fc1",
            "fields": {
              "transcription": "058410137e1449468fe9cc6e170f5fe3182cd12083b2172dd99a9731ebcf5f69"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          }
        },
        "timestamp": "2026-01-08T13:31:10.425295",
        "scenario_name": "Code change - audio field",
        "step_name": "update_audio_version"
      },
      {
        "type": "patch_applied",
        "patch_path": "patches/01_update_audio_version.patch",
        "before_snapshot": "8468950dcc9f75e4089529577e7b8ba044205e16a7c32b54910e7c73b9f7303d",
        "after_snapshot": "980943fbb9465022ca100716e64670fbbd80ef63636d4c23f18318454a77db4c",
        "before_graph": {
          "example/video": {
            "metaxy_feature_version": "bc9ca8356b1b8d2e2e25455bc8d0d4c51d00dfe826f08df38bbf8df0042fc890",
            "fields": {
              "audio": "2274238132e8ddf5b2f64bd926e35f3dbcf910e45f49a0d1f3383b1a28421b49",
              "frames": "794116a95021306600942624e8f40f8166c9ff87bb155835685c26a72a32fd85"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {}
            }
          },
          "example/crop": {
            "metaxy_feature_version": "3ac04df8f6503f82cbcd06f0e1cc5f4589c9bacb065b7edf22cd9567ad302c63",
            "fields": {
              "audio": "76c8bdc9545524e878ed4d9890587551b6c3154251cdfcca9049cbacf112cc39",
              "frames": "abc79017997391ffa25bdf04cbab84d77fdd22f4d2d78b914acad0662915e086"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "1ac83b074c018d1524eb51cf7f19734175b34c72f8289b6b90015f4a0ab9e2ce",
            "fields": {
              "faces": "2d75f0bd5be71867c23389d26bbd00eba2f3498dfff334dc0bbcaa9ec3893b07"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/stt": {
            "metaxy_feature_version": "c83a754a1749050d358b0e2572a7f3538ab5e76e18222f4c23dd7ef96e50b162",
            "fields": {
              "transcription": "ac412b3c78c2f910127bdd1511cf08ff0fe9324a80c0fe0503f2edabb22960d2"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          }
        },
        "after_graph": {
          "example/video": {
            "metaxy_feature_version": "6db302e5be0167551ad6a00df92e10a54ea63d7a6f393d420eeb23f24b540b10",
            "fields": {
              "audio": "09c8398bb8d6ef79c622cec3f7ee402cd55ad577a6002ddb7cd377b1a4af4377",
              "frames": "794116a95021306600942624e8f40f8166c9ff87bb155835685c26a72a32fd85"
            },
            "feature_spec": {
              "key": "example/video",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "2",
                  "deps": []
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": []
                }
              ],
              "metadata": {}
            }
          },
          "example/crop": {
            "metaxy_feature_version": "54dc7f8a47f2e4430707310fecc57101785040403680402b0013f5160024ee42",
            "fields": {
              "audio": "f3130c0fc1eb3967dbe4ed248be5b935334260f7afc5e0d878a5022c77b3475a",
              "frames": "abc79017997391ffa25bdf04cbab84d77fdd22f4d2d78b914acad0662915e086"
            },
            "feature_spec": {
              "key": "example/crop",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "audio",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                },
                {
                  "key": "frames",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/face_detection": {
            "metaxy_feature_version": "1ac83b074c018d1524eb51cf7f19734175b34c72f8289b6b90015f4a0ab9e2ce",
            "fields": {
              "faces": "2d75f0bd5be71867c23389d26bbd00eba2f3498dfff334dc0bbcaa9ec3893b07"
            },
            "feature_spec": {
              "key": "example/face_detection",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/crop",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "faces",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/crop",
                      "fields": [
                        "frames"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          },
          "example/stt": {
            "metaxy_feature_version": "066d34fcb84150b926500d1ba1172f53e3506643c743d4403a19128a6ae17fc1",
            "fields": {
              "transcription": "058410137e1449468fe9cc6e170f5fe3182cd12083b2172dd99a9731ebcf5f69"
            },
            "feature_spec": {
              "key": "example/stt",
              "id_columns": [
                "sample_uid"
              ],
              "deps": [
                {
                  "feature": "example/video",
                  "columns": null,
                  "rename": null,
                  "fields_mapping": {
                    "mapping": {
                      "type": "default",
                      "match_suffix": false,
                      "exclude_fields": []
                    }
                  },
                  "sql_filters": null,
                  "lineage": {
                    "relationship": {
                      "type": "1:1"
                    }
                  },
                  "optional": false
                }
              ],
              "fields": [
                {
                  "key": "transcription",
                  "code_version": "1",
                  "deps": [
                    {
                      "feature": "example/video",
                      "fields": [
                        "audio"
                      ]
                    }
                  ]
                }
              ],
              "metadata": {}
            }
          }
        },
        "timestamp": "2026-01-08T13:31:10.432529",
        "scenario_name": "Code change - audio field",
        "step_name": "update_audio_version"
      },
      {
        "type": "command_executed",
        "command": "metaxy graph-diff render latest current --format mermaid",
        "returncode": 0,
        "stdout": "---\ntitle: Feature Graph Changes\n---\nflowchart TB\n    %%{init: {'flowchart': {'htmlLabels': true, 'curve': 'basis'}, 'themeVariables': {'fontSize': '14px'}}}%%\n\n    example_video[\"<div style=\"text-align:left\"><b>example/video</b><br/>6db302<br/><font color=\"#999\">---</font><br/>- audio (09c839)<br/>- frames (794116)</div>\"]\n    example_crop[\"<div style=\"text-align:left\"><b>example/crop</b><br/>54dc7f<br/><font color=\"#999\">---</font><br/>- audio (f3130c)<br/>- frames (abc790)</div>\"]\n    example_face_detection[\"<div style=\"text-align:left\"><b>example/face_detection</b><br/>1ac83b<br/><font color=\"#999\">---</font><br/>- faces (2d75f0)</div>\"]\n    example_stt[\"<div style=\"text-align:left\"><b>example/stt</b><br/>066d34<br/><font color=\"#999\">---</font><br/>- transcription (058410)</div>\"]\n\n    example_video --> example_crop\n    example_crop --> example_face_detection\n    example_video --> example_stt\n\n",
        "stderr": "",
        "timestamp": "2026-01-08T13:31:11.792397",
        "scenario_name": "Code change - audio field",
        "step_name": "render_diff"
      }
    ]
  }
}
