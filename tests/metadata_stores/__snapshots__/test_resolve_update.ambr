# serializer version: 1
# name: test_resolve_update_detects_changes[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_ducklake_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'dbe64534abd5e364d1f4ca1a6869795a',
        }),
        dict({
          'default': 'cb822ef624057e3b28ad202916ac71dd',
        }),
        dict({
          'default': '2ce6657c9d962fc2fe2a2f593b8483f0',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '406dd66c968d8c3d387fd4b4df6db41e7c8ba1a0b9e648a5e5dd7aa7afbc5622',
        }),
        dict({
          'default': 'f8309593097668d4edead958395fd49b95893d2e9e7634503fa9f4b51fceca3b',
        }),
        dict({
          'default': '2fa77b085ee491e7e97f72c247013f8478ba3cb4465444e3fcba320c8e7725f6',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '406dd66c968d8c3d387fd4b4df6db41e7c8ba1a0b9e648a5e5dd7aa7afbc5622',
        }),
        dict({
          'default': 'f8309593097668d4edead958395fd49b95893d2e9e7634503fa9f4b51fceca3b',
        }),
        dict({
          'default': '2fa77b085ee491e7e97f72c247013f8478ba3cb4465444e3fcba320c8e7725f6',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '406dd66c968d8c3d387fd4b4df6db41e7c8ba1a0b9e648a5e5dd7aa7afbc5622',
        }),
        dict({
          'default': 'f8309593097668d4edead958395fd49b95893d2e9e7634503fa9f4b51fceca3b',
        }),
        dict({
          'default': '2fa77b085ee491e7e97f72c247013f8478ba3cb4465444e3fcba320c8e7725f6',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '406dd66c968d8c3d387fd4b4df6db41e7c8ba1a0b9e648a5e5dd7aa7afbc5622',
        }),
        dict({
          'default': 'f8309593097668d4edead958395fd49b95893d2e9e7634503fa9f4b51fceca3b',
        }),
        dict({
          'default': '2fa77b085ee491e7e97f72c247013f8478ba3cb4465444e3fcba320c8e7725f6',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '12037023440008030266',
        }),
        dict({
          'default': '17837839317980491560',
        }),
        dict({
          'default': '14558290314565373206',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '12037023440008030266',
        }),
        dict({
          'default': '17837839317980491560',
        }),
        dict({
          'default': '14558290314565373206',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '12037023440008030266',
        }),
        dict({
          'default': '17837839317980491560',
        }),
        dict({
          'default': '14558290314565373206',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '12037023440008030266',
        }),
        dict({
          'default': '17837839317980491560',
        }),
        dict({
          'default': '14558290314565373206',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3644544197',
        }),
        dict({
          'default': '3150898318',
        }),
        dict({
          'default': '3999303356',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4102418655400604945',
        }),
        dict({
          'default': '4485303282459113117',
        }),
        dict({
          'default': '16541571895607920915',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '672f21cfef6762f70dcf94fa355db6b7',
        }),
        dict({
          'default': 'e14fa6406edae92209947f24ee0dff64',
        }),
        dict({
          'default': '72831a0fd08d2d33b5246095e906d6a4',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '35fcd771d351a6d304dba3a390d062ae21db346d55dc0c37e17a4fad927f1481',
        }),
        dict({
          'default': 'bd3c7556de2f864ed50db24b4f05564fcd4458250e3c45d5af9b015fca4e51ff',
        }),
        dict({
          'default': '4e28090c2f0da85178a10f725e2ddcae0b19e6918c10b4e5eb8b0bb9c771ccbf',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '35fcd771d351a6d304dba3a390d062ae21db346d55dc0c37e17a4fad927f1481',
        }),
        dict({
          'default': 'bd3c7556de2f864ed50db24b4f05564fcd4458250e3c45d5af9b015fca4e51ff',
        }),
        dict({
          'default': '4e28090c2f0da85178a10f725e2ddcae0b19e6918c10b4e5eb8b0bb9c771ccbf',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '35fcd771d351a6d304dba3a390d062ae21db346d55dc0c37e17a4fad927f1481',
        }),
        dict({
          'default': 'bd3c7556de2f864ed50db24b4f05564fcd4458250e3c45d5af9b015fca4e51ff',
        }),
        dict({
          'default': '4e28090c2f0da85178a10f725e2ddcae0b19e6918c10b4e5eb8b0bb9c771ccbf',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '35fcd771d351a6d304dba3a390d062ae21db346d55dc0c37e17a4fad927f1481',
        }),
        dict({
          'default': 'bd3c7556de2f864ed50db24b4f05564fcd4458250e3c45d5af9b015fca4e51ff',
        }),
        dict({
          'default': '4e28090c2f0da85178a10f725e2ddcae0b19e6918c10b4e5eb8b0bb9c771ccbf',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '14384979659561295483',
        }),
        dict({
          'default': '16393741906645701913',
        }),
        dict({
          'default': '1503451087436268925',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '14384979659561295483',
        }),
        dict({
          'default': '16393741906645701913',
        }),
        dict({
          'default': '1503451087436268925',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '14384979659561295483',
        }),
        dict({
          'default': '16393741906645701913',
        }),
        dict({
          'default': '1503451087436268925',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '14384979659561295483',
        }),
        dict({
          'default': '16393741906645701913',
        }),
        dict({
          'default': '1503451087436268925',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3076203247',
        }),
        dict({
          'default': '2996209608',
        }),
        dict({
          'default': '1133952890',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '5703117408664097056',
        }),
        dict({
          'default': '6708236814926810383',
        }),
        dict({
          'default': '7678115697944854051',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0306c660f4a3dacc3ceb756ef5f3fc6c',
        }),
        dict({
          'default': '7e56c6df2f437a8885372d4cd1cd5a66',
        }),
        dict({
          'default': '82b916af3feb89882deb331e90c903d5',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2121e2490c3186daa2f01a15b0b1964870964899e34ea75ca7c2d5497fd12c21',
        }),
        dict({
          'default': 'e06a446014c2fd4a83251e9f766a7059fac3e1be9adc75de7b8093042ba07f20',
        }),
        dict({
          'default': 'c007a95606c4aef5d55bd9ea8297df277ac7141bb7a698882307efe73110e2f8',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2121e2490c3186daa2f01a15b0b1964870964899e34ea75ca7c2d5497fd12c21',
        }),
        dict({
          'default': 'e06a446014c2fd4a83251e9f766a7059fac3e1be9adc75de7b8093042ba07f20',
        }),
        dict({
          'default': 'c007a95606c4aef5d55bd9ea8297df277ac7141bb7a698882307efe73110e2f8',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2121e2490c3186daa2f01a15b0b1964870964899e34ea75ca7c2d5497fd12c21',
        }),
        dict({
          'default': 'e06a446014c2fd4a83251e9f766a7059fac3e1be9adc75de7b8093042ba07f20',
        }),
        dict({
          'default': 'c007a95606c4aef5d55bd9ea8297df277ac7141bb7a698882307efe73110e2f8',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2121e2490c3186daa2f01a15b0b1964870964899e34ea75ca7c2d5497fd12c21',
        }),
        dict({
          'default': 'e06a446014c2fd4a83251e9f766a7059fac3e1be9adc75de7b8093042ba07f20',
        }),
        dict({
          'default': 'c007a95606c4aef5d55bd9ea8297df277ac7141bb7a698882307efe73110e2f8',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '7390310183463134559',
        }),
        dict({
          'default': '9345967191715740243',
        }),
        dict({
          'default': '10240232034455902977',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '7390310183463134559',
        }),
        dict({
          'default': '9345967191715740243',
        }),
        dict({
          'default': '10240232034455902977',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '7390310183463134559',
        }),
        dict({
          'default': '9345967191715740243',
        }),
        dict({
          'default': '10240232034455902977',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '7390310183463134559',
        }),
        dict({
          'default': '9345967191715740243',
        }),
        dict({
          'default': '10240232034455902977',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2923999235',
        }),
        dict({
          'default': '2678760928',
        }),
        dict({
          'default': '3500821944',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'duckdb_ducklake',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '10367360247745986975',
        }),
        dict({
          'default': '11278615146878285687',
        }),
        dict({
          'default': '2591597587625471298',
        }),
      ]),
    }),
  })
# ---
