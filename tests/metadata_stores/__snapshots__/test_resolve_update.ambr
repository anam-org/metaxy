# serializer version: 1
# name: test_resolve_update_detects_changes[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_ids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 0,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_ids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '97026395bb2471ea3fbf4daf93bf5b317d11cac373f6faaeb18f72f81cab3840',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=False': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'sqlite_native=True': dict({
      'feature_version': '83317d2c0e3d0347867141772dab6b92d2e6823f86eed203fdf2a67184f16338',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'field_a': 'hash1',
        }),
        dict({
          'field_a': 'hash2',
        }),
        dict({
          'field_a': 'hash3',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0d39544fe1df2584a3cf8217f1955f05',
        }),
        dict({
          'default': 'dff5ecad81829dfb54f43ea50bd1fd77',
        }),
        dict({
          'default': '14bcbd4e7544a289ac23b6b1f0bb0a5d',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'eb44bac307e92fb42f678eed19b5bbf8141e4394def6820e6ad1d62ddb977776',
        }),
        dict({
          'default': '56bd190123e3edd845993eab7478ea5c3c867222624856c295a969b3e13f2d53',
        }),
        dict({
          'default': '90c6c2b5da6bc887874bb409e56498dd933d2b9fe0d3034e2126d9c1b08551b2',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'eb44bac307e92fb42f678eed19b5bbf8141e4394def6820e6ad1d62ddb977776',
        }),
        dict({
          'default': '56bd190123e3edd845993eab7478ea5c3c867222624856c295a969b3e13f2d53',
        }),
        dict({
          'default': '90c6c2b5da6bc887874bb409e56498dd933d2b9fe0d3034e2126d9c1b08551b2',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'eb44bac307e92fb42f678eed19b5bbf8141e4394def6820e6ad1d62ddb977776',
        }),
        dict({
          'default': '56bd190123e3edd845993eab7478ea5c3c867222624856c295a969b3e13f2d53',
        }),
        dict({
          'default': '90c6c2b5da6bc887874bb409e56498dd933d2b9fe0d3034e2126d9c1b08551b2',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': 'eb44bac307e92fb42f678eed19b5bbf8141e4394def6820e6ad1d62ddb977776',
        }),
        dict({
          'default': '56bd190123e3edd845993eab7478ea5c3c867222624856c295a969b3e13f2d53',
        }),
        dict({
          'default': '90c6c2b5da6bc887874bb409e56498dd933d2b9fe0d3034e2126d9c1b08551b2',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '123390034804307976',
        }),
        dict({
          'default': '6872978376765017629',
        }),
        dict({
          'default': '17278754091443902738',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '123390034804307976',
        }),
        dict({
          'default': '6872978376765017629',
        }),
        dict({
          'default': '17278754091443902738',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '123390034804307976',
        }),
        dict({
          'default': '6872978376765017629',
        }),
        dict({
          'default': '17278754091443902738',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '123390034804307976',
        }),
        dict({
          'default': '6872978376765017629',
        }),
        dict({
          'default': '17278754091443902738',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '867505226',
        }),
        dict({
          'default': '2266382774',
        }),
        dict({
          'default': '1230632888',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '4966707627859446777',
        }),
        dict({
          'default': '235412526042153429',
        }),
        dict({
          'default': '14713360912878806325',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '0acdb7f6161458eca7d3ecb575ac8157',
        }),
        dict({
          'default': '7fe23937bfc03597febc3ed63f88efdd',
        }),
        dict({
          'default': '4dff82a37a131df51773a31e57842efe',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '30b0773a9f75872a3de162a9188f655cc774b0b5d0792aac22b960b5b1c328bb',
        }),
        dict({
          'default': '74dddc598b420cbe9f76f5603bc14c636693d4b26d91596ea6565707535b296f',
        }),
        dict({
          'default': 'eb6fd0726d9cec37a6fdb0b979363b55caf7bc95378604b3d2d769eaa939acb5',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '30b0773a9f75872a3de162a9188f655cc774b0b5d0792aac22b960b5b1c328bb',
        }),
        dict({
          'default': '74dddc598b420cbe9f76f5603bc14c636693d4b26d91596ea6565707535b296f',
        }),
        dict({
          'default': 'eb6fd0726d9cec37a6fdb0b979363b55caf7bc95378604b3d2d769eaa939acb5',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '30b0773a9f75872a3de162a9188f655cc774b0b5d0792aac22b960b5b1c328bb',
        }),
        dict({
          'default': '74dddc598b420cbe9f76f5603bc14c636693d4b26d91596ea6565707535b296f',
        }),
        dict({
          'default': 'eb6fd0726d9cec37a6fdb0b979363b55caf7bc95378604b3d2d769eaa939acb5',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '30b0773a9f75872a3de162a9188f655cc774b0b5d0792aac22b960b5b1c328bb',
        }),
        dict({
          'default': '74dddc598b420cbe9f76f5603bc14c636693d4b26d91596ea6565707535b296f',
        }),
        dict({
          'default': 'eb6fd0726d9cec37a6fdb0b979363b55caf7bc95378604b3d2d769eaa939acb5',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '927281642926886638',
        }),
        dict({
          'default': '14178823899371069400',
        }),
        dict({
          'default': '9252987291507823250',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '927281642926886638',
        }),
        dict({
          'default': '14178823899371069400',
        }),
        dict({
          'default': '9252987291507823250',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '927281642926886638',
        }),
        dict({
          'default': '14178823899371069400',
        }),
        dict({
          'default': '9252987291507823250',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '927281642926886638',
        }),
        dict({
          'default': '14178823899371069400',
        }),
        dict({
          'default': '9252987291507823250',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '3578648704',
        }),
        dict({
          'default': '3452536830',
        }),
        dict({
          'default': '636943142',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11411736643231777167',
        }),
        dict({
          'default': '14801318926339089446',
        }),
        dict({
          'default': '2721567647438705335',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '15c99147081de3e3389d6d093fb3b5f4',
        }),
        dict({
          'default': 'f043aa59fa873d5c207d600a3a7d2bbd',
        }),
        dict({
          'default': 'c46a94366b9883b311f8bbc28b8bdb77',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '42395f8ed6fdcaa8180557a7cc4a5bd9f166242b54d97d1fcaa6ebe011412f44',
        }),
        dict({
          'default': 'b05146a5cafeab40547589835c5ebda9b4075e77dce9d949a82617fa936ffce4',
        }),
        dict({
          'default': '994fc56c9fd5bb996055b40601ef3d096c2a3918cf4916c18b368994abc749be',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '42395f8ed6fdcaa8180557a7cc4a5bd9f166242b54d97d1fcaa6ebe011412f44',
        }),
        dict({
          'default': 'b05146a5cafeab40547589835c5ebda9b4075e77dce9d949a82617fa936ffce4',
        }),
        dict({
          'default': '994fc56c9fd5bb996055b40601ef3d096c2a3918cf4916c18b368994abc749be',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '42395f8ed6fdcaa8180557a7cc4a5bd9f166242b54d97d1fcaa6ebe011412f44',
        }),
        dict({
          'default': 'b05146a5cafeab40547589835c5ebda9b4075e77dce9d949a82617fa936ffce4',
        }),
        dict({
          'default': '994fc56c9fd5bb996055b40601ef3d096c2a3918cf4916c18b368994abc749be',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '42395f8ed6fdcaa8180557a7cc4a5bd9f166242b54d97d1fcaa6ebe011412f44',
        }),
        dict({
          'default': 'b05146a5cafeab40547589835c5ebda9b4075e77dce9d949a82617fa936ffce4',
        }),
        dict({
          'default': '994fc56c9fd5bb996055b40601ef3d096c2a3918cf4916c18b368994abc749be',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11187915343910005673',
        }),
        dict({
          'default': '4705812906632822016',
        }),
        dict({
          'default': '11521929533859639442',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11187915343910005673',
        }),
        dict({
          'default': '4705812906632822016',
        }),
        dict({
          'default': '11521929533859639442',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11187915343910005673',
        }),
        dict({
          'default': '4705812906632822016',
        }),
        dict({
          'default': '11521929533859639442',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '11187915343910005673',
        }),
        dict({
          'default': '4705812906632822016',
        }),
        dict({
          'default': '11521929533859639442',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '2768709589',
        }),
        dict({
          'default': '1756486341',
        }),
        dict({
          'default': '1005213295',
        }),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
    tuple(
      'sqlite',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'removed': 0,
      'versions': list([
        dict({
          'default': '13499756664507170665',
        }),
        dict({
          'default': '10833401421581388075',
        }),
        dict({
          'default': '17547698760716450721',
        }),
      ]),
    }),
  })
# ---
