# serializer version: 1
# name: test_resolve_update_detects_changes[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 9,
      'changed_sample_uids': list([
        1,
        1,
        1,
        2,
        2,
        2,
        3,
        3,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_detects_changes[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 0,
      'any_metaxy_changed': True,
      'any_version_changed': True,
      'changed': 3,
      'changed_sample_uids': list([
        1,
        2,
        3,
      ]),
      'removed': 0,
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[multi_field-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '70c6be12249631e16e814cba005c5653f999e7a659400ff3efc4ee7196f6370f',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-md5]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-sha256]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-wyhash]
  dict({
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash32]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_feature_version_change_idempotency[simple_chain-xxhash64]
  dict({
    'clickhouse_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'clickhouse_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'duckdb_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=False': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
    'inmemory_native=True': dict({
      'feature_version': '41c074195bddc1d5004115b121467b9c46d466f4820a60be1cd0b89eacad512d',
      'first_run': dict({
        'added': 3,
        'changed': 0,
        'removed': 0,
      }),
      'second_run': dict({
        'added': 0,
        'changed': 0,
        'removed': 0,
      }),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[False-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-False-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '79cb5785f8d0080be0a640aa2a9e6020',
        'fdf243c6995dbbad23f41215bd1ee035',
        '3612a5f9b61c5eff0cdeccafd6c54006',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'be680b879a53edb6e82af475c0b92aa5be85ce5b09650a659a925cebf9dc55ff',
        'e9e62cb292c79a50b769173ebb96acecc54b7a5850285800adc3d518e305029e',
        'a3a62f1769ce5cd84b633d96cc3965f09b85aec8375741bb4bcfd36a7046a95e',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '14096464584610339149',
        '9792489231841018392',
        '5993097639609968083',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1225170467',
        '1496639923',
        '770087977',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_no_upstream[True-True-simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '12162716959114173549',
        '4251707976569218117',
        '4831270681797406848',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'hash1',
        ]),
        list([
          'hash2',
        ]),
        list([
          'hash3',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'c0a1a6786d3bf1b777561068f29cd03f',
        '5c490bd6afea13851f91e3851698c224',
        '32217c58ec3bc23fec60ee0aee030d27',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'c09156fbfb990d4597071a6b793c5085',
        ]),
        list([
          '991c6cae20f79c9105c91bf3e8d8c5e7',
        ]),
        list([
          '1a0f6c5513ad687e16bbe06146ee2ffd',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '657da92f68f3522bf2256ca1066697e25011009dbdb4d27ba19a9a7c41bfe397',
        '13c80ff97a11e833e71bc1de91b1503ca7f293eef342298d9c74aff49ceb01cb',
        'b7d726b6b2c41a150a44ad229379fd2c77007baa8851cd150767c07ed60e9e46',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'f7524ea1ae8b19d4d5f00f9b9d2812d2c9240fe4fd48a3eb4d4a5d34989dab08',
        ]),
        list([
          '1774039a9abe8f85d0de9ba9f920f018e8f4a87677c0c7a24dfc1af8a3891c16',
        ]),
        list([
          'a0ea40d61f097f9fa5ee8f050738467b677c3da4f9c28cc1265b00b96ffe8461',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '657da92f68f3522bf2256ca1066697e25011009dbdb4d27ba19a9a7c41bfe397',
        '13c80ff97a11e833e71bc1de91b1503ca7f293eef342298d9c74aff49ceb01cb',
        'b7d726b6b2c41a150a44ad229379fd2c77007baa8851cd150767c07ed60e9e46',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'f7524ea1ae8b19d4d5f00f9b9d2812d2c9240fe4fd48a3eb4d4a5d34989dab08',
        ]),
        list([
          '1774039a9abe8f85d0de9ba9f920f018e8f4a87677c0c7a24dfc1af8a3891c16',
        ]),
        list([
          'a0ea40d61f097f9fa5ee8f050738467b677c3da4f9c28cc1265b00b96ffe8461',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7589378804576828818',
        '5106656564208186037',
        '14118775435196639584',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '993885779398080501',
        ]),
        list([
          '17135022718363090530',
        ]),
        list([
          '7915124548529735192',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7589378804576828818',
        '5106656564208186037',
        '14118775435196639584',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '993885779398080501',
        ]),
        list([
          '17135022718363090530',
        ]),
        list([
          '7915124548529735192',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4056768547',
        '469588366',
        '4184779556',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1429738385',
        ]),
        list([
          '1290949724',
        ]),
        list([
          '2699592369',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[diamond_graph-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '4566648301740364284',
        '12926980212565057077',
        '15191727567051569071',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4300372016568822836',
        ]),
        list([
          '11296750709611896989',
        ]),
        list([
          '11107816722570511555',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '9a74a81196c55675aa7ea6f61eb5093b',
        'ec30270622412c2a1375e7a3e21f9aa1',
        'b878d9309ac3bd55a163059c1eafaba9',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'b23b32e8382ee8766523142dd415b470',
        ]),
        list([
          '11a696067c163eba302cdc35751bcec7',
        ]),
        list([
          '3d30aaebdc21420276f57044e6be5e76',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '95dbd6ca22394bdaf12093b438810e06b7a5214a2be68f63fbba37615c91e212',
        '69e4e53b8ef6a38abd17f9279cb9bba0261e95df8acbfa834209ef3720708fdd',
        '2c5019b78b8f0fa770640ea56ef2da24565374ca705e387c87b29970e89d2892',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '8f7e09777f0bde25b1d46d6a418ee5e4a3f5e425e21dc96fc543bde9612f408c',
        ]),
        list([
          '0c6f6e8fa659b4b984b3e72846985707fded5fd67e8861cebcb3d699be500307',
        ]),
        list([
          'c2c18022a2b2fde0689214804ae3157d99d9de0afb7680882a04f58fbad90341',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '95dbd6ca22394bdaf12093b438810e06b7a5214a2be68f63fbba37615c91e212',
        '69e4e53b8ef6a38abd17f9279cb9bba0261e95df8acbfa834209ef3720708fdd',
        '2c5019b78b8f0fa770640ea56ef2da24565374ca705e387c87b29970e89d2892',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '8f7e09777f0bde25b1d46d6a418ee5e4a3f5e425e21dc96fc543bde9612f408c',
        ]),
        list([
          '0c6f6e8fa659b4b984b3e72846985707fded5fd67e8861cebcb3d699be500307',
        ]),
        list([
          'c2c18022a2b2fde0689214804ae3157d99d9de0afb7680882a04f58fbad90341',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11445964042313877763',
        '7149628961979373659',
        '15235052686121949142',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '9692698650408845241',
        ]),
        list([
          '13382591668779843402',
        ]),
        list([
          '4942927040643065000',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11445964042313877763',
        '7149628961979373659',
        '15235052686121949142',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '9692698650408845241',
        ]),
        list([
          '13382591668779843402',
        ]),
        list([
          '4942927040643065000',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '311175219',
        '367245332',
        '3895120843',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '1950025289',
        ]),
        list([
          '1687818825',
        ]),
        list([
          '2498769386',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[multi_field-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '11802270729983453020',
        '10128682264698671608',
        '3573981669856498208',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '6901493504355078472',
        ]),
        list([
          '10416488366954694052',
        ]),
        list([
          '5245095240423042535',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-md5]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'b2d12ac62dc8bf1e9f0d2d01cab708fb',
        'dfccb0498a844a3f56f0bd243a6b4575',
        'f6b91be49fc50eb435b89b06910480fa',
      ]),
      'removed': 0,
      'versions': list([
        list([
          'dcf4820449756eda46eac200943bf296',
        ]),
        list([
          '56343b78046a2effbce1899ba2236aef',
        ]),
        list([
          'd30355212c95b5c26eec180856d0957c',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-sha256]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'ae596a7cce3888e5f67c59d5d7d54e36410695bb2f1512a60f93e5a1c7d7e8b1',
        '7b0e836788ce87723da997f6b9d824e2802bb3f1a81be515cda63e39530ceda1',
        '6a409e544afce3e7ae7c195cdd6751667ed666974f3490c8c911299656eb96e0',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4f0d3d10ef2671305df5b2004e30beda9cdef6d8039b488edb5b3f2a79bc0024',
        ]),
        list([
          '5e44bedc1ba93f0e6ed22a7baa0c21468a4a6a408a4b167eda3341f7ba2499c5',
        ]),
        list([
          '3679f96e83127e3f1d69dced253a2eb916fc2bb29e2ba9937f30ea020613d9b1',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        'ae596a7cce3888e5f67c59d5d7d54e36410695bb2f1512a60f93e5a1c7d7e8b1',
        '7b0e836788ce87723da997f6b9d824e2802bb3f1a81be515cda63e39530ceda1',
        '6a409e544afce3e7ae7c195cdd6751667ed666974f3490c8c911299656eb96e0',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '4f0d3d10ef2671305df5b2004e30beda9cdef6d8039b488edb5b3f2a79bc0024',
        ]),
        list([
          '5e44bedc1ba93f0e6ed22a7baa0c21468a4a6a408a4b167eda3341f7ba2499c5',
        ]),
        list([
          '3679f96e83127e3f1d69dced253a2eb916fc2bb29e2ba9937f30ea020613d9b1',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-wyhash]
  dict({
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1596495709968096517',
        '3345488515856354049',
        '14099317433332388863',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '17387136526003815266',
        ]),
        list([
          '842540692862782189',
        ]),
        list([
          '5033000392240567310',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '1596495709968096517',
        '3345488515856354049',
        '14099317433332388863',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '17387136526003815266',
        ]),
        list([
          '842540692862782189',
        ]),
        list([
          '5033000392240567310',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash32]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '3220639441',
        '1644076171',
        '3984822924',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '3713522432',
        ]),
        list([
          '4293435963',
        ]),
        list([
          '739354472',
        ]),
      ]),
    }),
  })
# ---
# name: test_resolve_update_with_upstream[simple_chain-xxhash64]
  dict({
    tuple(
      'clickhouse',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
    tuple(
      'clickhouse',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
    tuple(
      'duckdb',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      False,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
    tuple(
      'inmemory',
      True,
    ): dict({
      'added': 3,
      'changed': 0,
      'metaxy_provenances': list([
        '7135054265241781159',
        '592653590584345317',
        '4432416623018054600',
      ]),
      'removed': 0,
      'versions': list([
        list([
          '15572746059014705488',
        ]),
        list([
          '11415592233942295772',
        ]),
        list([
          '3735630102698355868',
        ]),
      ]),
    }),
  })
# ---
